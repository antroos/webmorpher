# Руководство по созданию автономного пакета WebMorpher

Данное руководство описывает процесс создания автономного пакета приложения WebMorpher для macOS, который можно легко распространять среди пользователей.

## Что такое автономный пакет

Автономный пакет WebMorpher — это полностью готовый к использованию `.app` пакет, который:

- Содержит все необходимые зависимости, включая Python и требуемые библиотеки
- Включает встроенный браузер Chromium через playwright
- Настроен для предотвращения проблем с многопоточностью OpenBLAS/NumPy
- Упакован в DMG-образ для удобного распространения
- Имеет приветственный экран для новых пользователей

## Преимущества для пользователей

- **Простая установка**: Просто перетащите приложение в папку Applications
- **Нет необходимости устанавливать Python**: Приложение содержит собственную копию Python
- **Нет необходимости устанавливать зависимости**: Все библиотеки включены в пакет
- **Решены известные проблемы**: Предотвращены проблемы с сегментацией из-за OpenBLAS
- **Приветственный экран**: Пользователь получает информацию о первых шагах при запуске
- **Утилита обновления браузера**: Включен скрипт для обновления Chromium при необходимости

## Создание пакета

### Предварительные требования

- macOS 10.15 Catalina или новее
- Python 3.11 установлен на компьютере разработчика
- Доступ к интернету для загрузки зависимостей

### Шаги по созданию пакета

1. Убедитесь, что у вас есть актуальная версия кода WebMorpher
2. Откройте терминал и перейдите в корневую директорию проекта
3. Запустите скрипт создания пакета:

```bash
./create_standalone_app.sh
```

4. Дождитесь завершения процесса (это может занять несколько минут)
5. После успешного завершения вы получите:
   - Готовый пакет `WebMorpher.app`
   - DMG-образ `WebMorpher-Standalone.dmg` для распространения

## Распространение приложения

Для распространения приложения среди пользователей:

1. Передайте пользователю файл `WebMorpher-Standalone.dmg`
2. Пользователь должен открыть DMG-образ и перетащить приложение WebMorpher в папку Applications
3. При первом запуске пользователь увидит приветственное окно с инструкциями
4. Затем пользователь должен будет ввести свой API-ключ OpenAI

## Особенности автономного пакета

### Приветственное окно

При первом запуске приложения пользователь увидит окно приветствия с инструкциями по началу работы:
- Информация о приложении
- Как получить API-ключ OpenAI
- Основные шаги для начала работы
- Флажок "Не показывать это окно при следующем запуске"

### Утилита обновления браузера

В пакет включена утилита для обновления или переустановки браузера Chromium:
- Расположена в `WebMorpher.app/Contents/Resources/update_browser.command`
- Пользователь может запустить ее двойным щелчком, если возникли проблемы с браузером
- Автоматически находит установленное приложение и обновляет браузер

## Возможные проблемы и их решение

### Приложение не запускается

Если приложение не запускается, возможно, macOS блокирует его запуск из-за того, что оно получено не из App Store. Для разрешения запуска:

1. Откройте Finder и перейдите в папку Applications
2. Нажмите правой кнопкой мыши на WebMorpher и выберите "Открыть"
3. В появившемся диалоговом окне нажмите "Открыть"

После этого приложение должно запуститься и в дальнейшем запускаться без предупреждений.

### Приложение запускается, но не открывается браузер

Если приложение запускается, но не может открыть браузер, рекомендуйте пользователю:

1. Запустить утилиту обновления браузера: двойной щелчок по `update_browser.command` в Finder
2. Или запустить в терминале:

```bash
open -a "WebMorpher" --args --install-browser
```

## Техническая информация

Автономный пакет создан с использованием следующих технологий:

- Python 3.11 виртуальное окружение внутри `.app` пакета
- PyQt5 для пользовательского интерфейса
- Playwright и browser-use для автоматизации браузера
- NumPy 1.25.2 с ограничением многопоточности для предотвращения сбоев
- Скрипты bash для автоматизации установки и настройки

## Дополнительная информация

Если у вас возникли проблемы с созданием или использованием автономного пакета, обратитесь к файлу TROUBLESHOOTING.md или создайте issue в репозитории проекта. 